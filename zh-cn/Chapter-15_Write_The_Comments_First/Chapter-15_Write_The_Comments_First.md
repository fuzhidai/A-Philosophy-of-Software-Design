许多开发者将文档的编写，推迟到开发接近尾声之时，也就是在编码和单测完成之后，这无疑会导致文档质量的下降。编写注释的最佳时机，是在整个过程的开始阶段，即在你编写代码时。首先编写注释使文档成为设计流程的一部分，这不仅可以产生更好的文档，而且还可以产生更好的设计，这让编写文档的过程变得更加有趣。

### 15.1 延迟的注释是不好的注释

几乎我们见过的每个开发者，都会推迟注释的编写。当我们询问他们为什么不尽早编写文档时，他们回答说代码仍在变化中，如果他们过早编写文档，那当代码发生变化时，他们就需要再重新编写文档，所以最好等到代码稳定后，再进行文档的编写。可是我猜测这里还有另外一个原因，即他们将编写文档视为一项苦差事，因此，他们尽可能久的推迟文档的编写。

不幸的是，这样的做法可能会带来一些不好的结果。首先，延迟文档的编写，通常意味着永远不会进行编写。一旦你开始拖延，就很容易再拖延更多的一些时间，毕竟，再过几周代码会更加稳定。当代码变得无可争辩的稳定时，往往已经积累和很多代码，这意味着编写文档，变成了一个非常巨大且毫无吸引力的任务。从来都不会有一个适当的时间，专门暂停几天用于补充所有缺失的注释，此时很容易合理化的认为，当前对于项目最佳的事情，就是继续前进并修复漏洞，或开始开发下一个特性。而这将会产生更多无注释的代码。

哪怕如果你有很强的自律性，使得你能够回去编写注释（不要欺骗你自己，你大概率不会这样做），此时的注释也不会非常好。到了这个阶段，你已经在心里完成了核对。在你的脑海中，这段代码已经完成了，你更想要向前推进，进入到下一个项目中。你知道编写注释是正确的事情，但是它很无趣，你只想尽可能快的完成它。因此，你快速浏览代码，添加恰好适量的注释，让其看起来还不错。到目前为止，距离你设计代码已经过了一段时间，所以你记忆中的设计过程已经变得模糊。编写注释时对照着代码，因此注释只是重复了代码的逻辑。即使你尝试重构代码中并不明显的设计思想，也会有一些你已经忘记的事情。因此，注释遗漏了那些本应描述的重要事情。

### 15.2 优先编写注释

我采用几种不同的方式来编写注解，并且是在非常初始的地方进行。

* 对于一个新的类，我从编写类接口的注释开始。
* 接下来，我为那些相对重要的公有方法，编写接口的注释和签名，但我会让方法体留白。
* 我对这些注释进行了一些迭代，直到感觉基础结构足够正确为止。
* 此时，我为类实例中最重要的一些变量编写声明和注释。
* 最后，我填充这些方法体，并按需增加对于实现的注释，
* 当编写方法体时，我通常发现额外所需的方法和实例变量。对于每个新增的方法，我都会在实现方法体之前编写接口注释。对于实例变量，我会在编写变量声明的同时，填充相关注释。

当代码编写完成时，注释也同时完成，从来不会积压未编写的注释。

注释优先的方法有三个好处。首先，它产生了更好的注释。如果你在设计类的同时编写注释，关键的设计问题在你的脑海中将会非常清晰，所以你很容易去记录它们。其次，对于每个方法，在编写方法体之前，首先编写方法接口注释会更好一些，因为这样你就可以聚焦于方法的抽象和接口，而不会被实现所干扰。而在编码和测试的过程中，你将注意并修复注释中的问题。最终，注释将会改善开发的整个流程。